<!DOCTYPE html>
<html>
<head>
    <title>Video Configuration</title>
    <meta charset="utf-8">
    <link href="../base1/bootstrap.min.css" type="text/css" rel="stylesheet">
    <script src="./qrcode.js"></script>
    <script src="../base1/cockpit.js"></script>
</head>

<body>
    <div class="pf-c-page" id="noServerSection">
        <main class="pf-c-page__main" tabindex="-1">
            <section class="pf-c-page__main-section pf-m-light m-3">
                <p class="text-danger">Error: The video services are not running, this section is not available.</p>
            </section> 
        </main>
    </div>
        
    <div class="pf-c-page" id="mainSection">
        <main class="pf-c-page__main" tabindex="-1">

            <section class="pf-c-page__main-section pf-m-light">

                <div class="row justify-content-start">
                    <div class="col-lg-12 ms-3"><p class="fw-bold fs-2 mt-3 mb-0">Video Configuration</p> </div>                    
                   
                    <div class="col-lg-12 ms-3"><p class="mt-1 me-3">Use the settings below to change the video streaming settings. To disable the stream, set the Bitrate to "Disabled".</p></div>
                    <div class="col-lg-12 ms-3"><p class="mt-1 me-3">The MK1 in this configuration is designed to be used with a Raptor gimbal + TRIP6 module set up with TRIP6 firmware v.1.11.10+.  On the TRIP6 configuration, one of the two configured streams <strong>must be</strong> pointing to this IP address (<strong><span id='myIP'></span></strong>) and using the port defined below.</p></div>
                   
                    
                <div class="row justify-content-start">
                    <div class="col ms-3"><p class="fw-bold fs-5 mt-3 mb-0"><img src="settings_ethernet.svg" class="me-2">TRIP6 Stream Setup</p><p class="fw-light fs-6">Input the port used to received video from the TRIP6 system onboard the MK1. This should match the Channel-0-Settings > Video > 2nd Stream Destination Port on the TRIP6 configuration page. Default value is 7000.</p></div>   
                </div>

                <div class="row justify-content-start">
                    <div class="col-2 ms-3 mt-3"><label class="control-label" for="gimbalPort">TRIP6 Video Receive Port</label></div>
                    <div class="col mt-3"><input id="gimbalPort"></div></div>
                </div>

                <div class="row justify-content-start">
                    <div class="col ms-3"><p class="fw-bold fs-5 mt-3 mb-0"><img src="settings_ethernet.svg" class="me-2">Server Stream Setup</p><p class="fw-light fs-6">Input the parameters to control the cloud video stream. Use of this stream requires the MK1 to have internet connection. For LTE, it is recommended to use the lowest bitrate which provides acceptable quality. The Stream Name is a unique ID for the video stream, typically set to the aircraft's serial number.</p></div>   
                </div>

                <div class="row justify-content-start">
                    <div class="col-2 ms-3 mt-3"><label class="control-label" for="videoHost">Server URL</label></div>
                    <div class="col mt-3"><input id="videoHost"></div>
                </div>
                <!--<div class="row justify-content-start">
                    <div class="col-2 ms-3 mt-3"><label class="control-label" for="videoPort">Port</label></div>
                    <div class="col mt-3"><input id="videoPort"></div>
                </div>
                -->

                <div class="row justify-content-start">
                    <div class="col-2 ms-3 mt-3"><label class="control-label" for="videoBitrate">Bitrate (kbps)</label></div>
                    <div class="col mt-3"><select id="videoBitrate"></select></div>
                </div>


                <div class="row justify-content-start">
                    <div class="col-2 ms-3 mt-3"><label class="control-label" for="videoName">Stream Name</label></div>
                    <div class="col mt-3"><input id="videoName"></div>
                </div>

                <div class="row justify-content-start">
                    <div class="col-2 ms-3 mt-3"><label class="control-label" for="videoName">Stream URL</label></div>
                    <div class="col mt-3"><text id="serverURL"></div>
                </div>
                <div class="row justify-content-start">
                    <div class="col-2 ms-3 mt-3"><label class="control-label" for="videoName">Stream QR Code</label></div>
                    <div class="col mt-3"><div id="qrcode" style="width:100px; height:100px; margin-top:15px;"></div>                     
                        <script type="text/javascript">
                        new QRCode(document.getElementById("qrcode"), "https://webisora.com");
                        </script>                                 
                    </div>
                </div>
              
                <div class="row justify-content-start">
                    <div class="col-2 ms-3 mt-3"><button class="btn-primary" id="save">Save/Update</button></div>
                    <div class="col mt-3"><span id="result"></span></div>
                </div>

                <div class="alert alert-info m-3 mt-5" role="alert">
                   <p class="mt-1 me-3">The TRIP6 Settings must match those below:</p>
                        <ul>
                            <li>Channel-0 Settings > Video > Encapsulation Format = <strong>RTP/AVP</strong></li>
                            <li>Channel-0 Settings > Video > Destination IP = <strong>The endpoint of the primary local GCS</strong></li>
                            <li>Channel-0 Settings > Video > Destination Port = <strong>The port used by the GCS to receive video, typically 5600</strong></li>
                            <li>Channel-0 Settings > Video > 2nd Stream Enable = <strong>Checked/True</strong></li>
                            <li>Channel-0 Settings > Video > 2nd Stream Destination IP = <strong>The IP address of this EchoPilot AI device, <strong><span id='myIP2'></span></strong>.</li>
                            <li>Channel-0 Settings > Video > 2nd Stream Destination Port = <strong>The port you wish to receive video on with this app, must match the setting below. The default value is 7000.</strong></li>
                            <li>Channel-0 Settings > Encoder Settings > Stream Bitrate = <strong>~2000 [kbps]</strong></li>
                        </ul>                    
                </div>


                <pre id="output"></pre>
            </section>
        </main>
    </div>

    <script src="video.js"></script>
</body>
</html>

